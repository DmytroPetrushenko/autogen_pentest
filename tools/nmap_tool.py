import nmap


def nmap_scanner(host: str, ports: str, arguments: str) -> str:
    """
    this tool is used to scan the network using map.

    Parameters:
    - host (str): The IP address or hostname of the target to scan. Can also be a range of IPs.
    - ports (str): The specific port or range of ports to scan. If `None` or an empty string,
                   all ports are scanned.
    - arguments (str): Additional command-line arguments to pass to Nmap. If `None` or an empty
                       string, defaults to "-sV".

    Returns:
    - str: The results of the scan in CSV format, as provided by Nmap's `.csv()` method.

    Example:
    >>> results = get_scan_results_as_csv('192.168.1.1', '22,80', '-A')
    >>> print(results)
    """
    # If the arguments contain '-p', remove it (assuming '-p' should not be port-unspecified)
    args = arguments.replace('-p', '') if arguments and '-p' in arguments else arguments

    # Performing a scan
    port_scanner = nmap.PortScanner()
    port_scanner.scan(hosts=host, ports=ports if ports else None, arguments=args if args else "-sV")

    return port_scanner.csv()
