import tempfile
from autogen import UserProxyAgent
from autogen.coding import DockerCommandLineCodeExecutor
from pathlib import Path
from typing import Optional, Union


class ExecutorAgent(UserProxyAgent):
    def __init__(self, code_execution_config: dict):
        super().__init__(
            name="executor_agent",
            human_input_mode="NEVER",
            code_execution_config=code_execution_config,
            llm_config=None,
            description="Execute Python code obtained from other agents."
        )


class ExecuteInDocker(DockerCommandLineCodeExecutor):
    def __init__(self,
                 image: str,
                 container_name: Optional[str],
                 timeout: int = 60,
                 auto_remove: bool = True,
                 stop_container: bool = True
                 ):
        self.temporary_directory = tempfile.TemporaryDirectory()
        super().__init__(image, container_name, timeout, self.temporary_directory.name, auto_remove, stop_container)



